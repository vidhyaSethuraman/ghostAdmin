const {Client} = require('@elastic/elasticsearch');

class ElasticSearch {
    constructor(clientConfig, indexConfig) {
        this.client = new Client(clientConfig);
        this.index = indexConfig;
    }

    async write(data) {
        if (typeof data !== 'object') {
            throw new Error('Type Error: ElasticSearch transport requires log data to be an object');
        }

        await this.client.index({
            body: data,
            ...this.index
        });
    }
}

module.exports = ElasticSearch;
